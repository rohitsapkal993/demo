(()=>{"use strict";function i(i){var e=function(i){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={text:{"application/vnd.oasis.opendocument.text":"Text","text/plain":"Text"},file:{"text/html":"HTML","text/php":"PHP","x-httpd-php":"PHP","text/css":"CSS","text/js":"JavaScript","application/javascript":"JavaScript","application/json":"JSON","application/xml":"XML","application/x-shockwave-flash":"SWF","video/x-flv":"FLV","application/vnd.google-apps.file":"File"},image:{"application/vnd.google-apps.photo":"Photo","image/png":"PNG","image/jpeg":"JPEG","image/jpg":"JPG","image/gif":"GIF","image/bmp":"BMP","image/vnd.microsoft.icon":"ICO","image/tiff":"TIFF","image/tif":"TIF","image/svg+xml":"SVG"},zip:{"application/zip":"ZIP","application/x-rar-compressed":"RAR","application/x-msdownload":"EXE","application/vnd.ms-cab-compressed":"CAB"},audio:{"audio/mpeg":"MP3","video/quicktime":"QT","application/vnd.google-apps.audio":"Audio","audio/x-m4a":"Audio"},video:{"application/vnd.google-apps.video":"Video","video/x-flv":"Video","video/mp4":"Video","video/webm":"Video","video/ogg":"Video","application/x-mpegURL":"Video","video/MP2T":"Video","video/3gpp":"Video","video/quicktime":"Video","video/x-msvideo":"Video","video/x-ms-wmv":"Video"},pdf:{"application/pdf":"PDF"},word:{"application/msword":"MS Word"},doc:{"application/vnd.google-apps.document":"Google Docs"},excel:{"application/vnd.ms-excel":"Excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"Excel"},presentation:{"application/vnd.google-apps.presentation":"Slide","application/vnd.oasis.opendocument.presentation":"Presentation"},powerpoint:{"application/vnd.ms-powerpoint":"Powerpoint"},form:{"application/vnd.google-apps.form":"Form"},folder:{"application/vnd.google-apps.folder":"Folder"},drawing:{"application/vnd.google-apps.drawing":"Drawing"},script:{"application/vnd.google-apps.script":"Script"},sites:{"application/vnd.google-apps.sites":"Sites"},spreadsheet:{"application/vnd.google-apps.spreadsheet":"Spreadsheet","application/vnd.oasis.opendocument.spreadsheet":"Spreadsheet"}},a="File",o="file";return Object.keys(n).map((function(s){e&&n[s][i]?o=s:n[s][i]&&(a=n[s][i])})),e?o:a}(i,!0);return e=e||"file","".concat(upwpforms.pluginUrl,"/assets/images/icons/").concat(e,".png")}var e=wp.i18n.__,n=jQuery,a={init:function(){n(".upwpforms-uploader.google-drive-upload").each((function(){a.initUploader(n(this))}))},initUploader:function(a){var o=a.next(".upload-file-list"),s=a.parents("form"),t=a.find(".file-list"),d=s.find('button[type="submit"]'),l=a.data("form-id"),r=a.data("field-id"),p=a.data("folder-id"),c=a.data("account-id"),f=a.data("max-size"),m=a.data("max-post-size");(!f||f>m)&&(f=m);var u=a.data("min-size"),g=a.data("max-files"),v=a.data("extensions");v=v?v.replace(/\s/g,"").replace(/,+$/,""):"*";var h=[],_=function(i,e){if(e){var n=i.files,a=n.findIndex((function(i){return i.id===e.id}))+1;a<n.length&&x(i,n[a])}},x=function(i,e){i.stop();var n=t.find("#".concat(e.id));n.addClass("active"),wp.ajax.send("upwpforms_get_google_drive_upload_url",{data:{name:e.name,size:e.size,type:e.type,folder_id:p,account_id:c,form_id:l,field_id:r},success:function(e){i.setOption("url",e),i.start()},error:function(a){console.log(a),a.responseJSON&&a.responseJSON.data&&n.addClass("error").find(".file-info-error").text(a.responseJSON.data),_(i,e)}})},w='\n            <div class="file-list-item" id="">\n                    <img class="file-icon" width="32" height="32" src=""/>\n\n                    <div class="file-info">\n                        <div class="upload-item">\n                            <span class="upload-item-name"></span>\n                            <span class="upload-item-size"></span>\n                        </div>\n\n                        <div class="file-info-percentage">\n                            <i class="dashicons dashicons-saved"></i>\n                            <img class="spinner-icon" src="'.concat(upwpforms.pluginUrl,'/assets/images/spinner.gif"/>\n                            <span class="percentage">0%</span>\n                            <i class="dashicons dashicons-controls-pause"></i>\n                            <i class="dashicons dashicons-controls-play"></i>\n                            <i class="remove-file dashicons dashicons-no-alt"></i>\n                        </div>\n\n                        <span class="file-info-error"></span>\n                        <div class="file-info-progress">\n                            <span class="file-info-progress-bar"></span>\n                        </div>\n                    </div>\n                </div>\n            '),z=a.find(".upwpforms-uploader-browse"),b=a.find(".upwpforms-uploader-body"),y=new plupload.Uploader({browse_button:z[0],drop_element:b[0],multipart:!1,multi_selection:g>1,filters:{max_files:g,max_file_size:f,min_file_size:u,mime_types:[{title:e("Allowed files","upwpforms"),extensions:v}]},init:{postInit:function(i){t.on("click",".remove-file",(function(){var e=n(this).closest(".file-list-item"),a=e.attr("id");i.files.find((function(i){return i.id===a}))&&i.removeFile(i.getFile(a)),e.remove(),i.files.length<g&&b.removeClass("hidden")}))},FilesAdded:function(e,a){a.forEach((function(e){var a=n(w);a.attr("id",e.id),a.find(".upload-item-name").text(e.name),a.find(".upload-item-size").text("(".concat(plupload.formatSize(e.size),")")),a.find(".file-icon").attr("src",i(e.type)),t.append(a)})),d.prop("disabled",!0),x(e,a[0]),e.files.length>=g&&b.addClass("hidden")},FileUploaded:function(i,n,a){d.prop("disabled",!1);var o=t.find("#".concat(n.id));o.addClass("uploaded"),o.find(".percentage").text(e("Completed","upwpforms"));var s=JSON.parse(a.response),l={id:s.id,name:n.name,size:n.size,iconLink:s.iconLink,webViewLink:s.webViewLink,parents:s.parents};h.push(l),_(i,n)},UploadProgress:function(i,e){var n=t.find("#".concat(e.id));n.find(".file-info-progress-bar").css("width",e.percent+"%"),n.find(".percentage").text(e.percent+"%")},UploadComplete:function(i,e){d.prop("disabled",!1),h.length&&o.val(JSON.stringify(h)).trigger("change")},Error:function(a,o){console.log(o);var s=o.code,d=o.file,l=o.message,r=o.type,p=l;-600===s?(p=e("File size exceeds the maximum upload size.","integrate-google-drive")+"(".concat(f,")"),"min"===r&&(p=e("File size is less than the minimum upload size.","integrate-google-drive")+"(".concat(u,"mb)"))):-601===s?p=e("This file type is not allowed","integrate-google-drive"):"COUNT_ERROR"===s&&(p=e("This file was not uploaded. You can`t upload more than","integrate-google-drive")+" ".concat(g," ").concat(e("files","integrate-google-drive")));var c=n("#".concat(d.id));c.length?(c.find(".file-info-error").text(p),c.addClass("error")):setTimeout((function(){var e=n(w);e.attr("id",d.id),e.addClass("error"),e.find(".upload-item-name").text(d.name),e.find(".upload-item-size").text("(".concat(plupload.formatSize(d.size),")")),e.find(".file-icon").attr("src",i(d.type)),e.find(".file-info-error").text(p),t.append(e)}),100)}}});y.buildUrl=function(i,e){return i},plupload.addFileFilter("min_file_size",(function(i,e,n){(i=1024*i*1024)&&e.size<i?(this.trigger("Error",{code:plupload.FILE_SIZE_ERROR,file:e,type:"min"}),n(!1)):n(!0)})),plupload.addFileFilter("max_files",(function(i,e,n){i&&this.files.length>=i?(this.trigger("Error",{code:"COUNT_ERROR",file:e}),n(!1)):n(!0)})),y.init()}};const o=a;$=jQuery;var s={init:function(){$(".upwpforms-uploader.upwpforms-file-upload").each((function(){s.initUploader($(this))}))},initUploader:function(e){var n=e.next(".upload-file-list"),a=e.parents("form"),o=e.find(".file-list"),s=a.find('button[type="submit"]'),t=e.data("max-size"),d=e.data("max-post-size");(!t||t>d)&&(t=d);var l=e.data("field-id"),r=e.data("form-id"),p=e.data("min-size"),c=e.data("max-files"),f=e.data("extensions");f=f?f.replace(/\s/g,"").replace(/,+$/,""):"*";var m=e.data("media-library"),u=[],g='\n            <div class="file-list-item" id="">\n                    <img class="file-icon" width="32" height="32" src=""/>\n\n                    <div class="file-info">\n                        <div class="upload-item">\n                            <span class="upload-item-name"></span>\n                            <span class="upload-item-size"></span>\n                        </div>\n\n                        <div class="file-info-percentage">\n                            <i class="dashicons dashicons-saved"></i>\n                            <img class="spinner-icon" src="'.concat(upwpforms.pluginUrl,'/assets/images/spinner.gif"/>\n                            <span class="percentage">0%</span>\n                            <i class="dashicons dashicons-controls-pause"></i>\n                            <i class="dashicons dashicons-controls-play"></i>\n                            <i class="remove-file dashicons dashicons-no-alt"></i>\n                        </div>\n\n                        <span class="file-info-error"></span>\n                        <div class="file-info-progress">\n                            <span class="file-info-progress-bar"></span>\n                        </div>\n                    </div>\n                </div>\n            '),v=e.find(".upwpforms-uploader-browse"),h=e.find(".upwpforms-uploader-body"),_=new plupload.Uploader({browse_button:v[0],drop_element:h[0],url:upwpforms.ajaxUrl,multi_selection:c>1,multipart_params:{action:"upwpforms_upload_file",nonce:upwpforms.nonce,media_library:m,field_id:l,form_id:r},filters:{max_files:c,max_file_size:t,min_file_size:p,mime_types:[{title:wp.i18n.__("Allowed files","upwpforms"),extensions:f}]},init:{postInit:function(i){o.on("click",".remove-file",(function(){var e=$(this).closest(".file-list-item"),n=e.attr("id"),a=i.files;a.find((function(i){return i.id===n}))&&i.removeFile(i.getFile(n)),e.remove(),a.length<c&&h.removeClass("hidden")}))},FilesAdded:function(e,n){n.forEach((function(e){var n=$(g);n.attr("id",e.id),n.find(".upload-item-name").text(e.name),n.find(".upload-item-size").text(plupload.formatSize(e.size)),n.find(".file-icon").attr("src",i(e.type)),o.append(n)})),e.files.length>=c&&h.addClass("hidden"),e.start()},FileUploaded:function(i,e,n){var a=o.find("#".concat(e.id));a.addClass("uploaded"),a.find(".percentage").text(wp.i18n.__("Completed","upwpforms"));var t=JSON.parse(n.response);console.log(t),u.push(t.data),s.prop("disabled",!1)},UploadProgress:function(i,e){s.prop("disabled",!0);var n=o.find("#".concat(e.id));n.addClass("active"),n.find(".file-info-progress-bar").css("width",e.percent+"%"),n.find(".percentage").text(e.percent+"%")},UploadComplete:function(i,e){s.prop("disabled",!1),u.length&&n.val(JSON.stringify(u)).trigger("change")},Error:function(e,n){console.log(n);var a=n.code,s=n.file,d=n.message,l=n.type,r=n.response,f=d;-600===a?(f=wp.i18n.__("File size exceeds the maximum upload size.","integrate-google-drive")+"(".concat(t,")"),"min"===l&&(f=wp.i18n.__("File size is less than the minimum upload size.","integrate-google-drive")+"(".concat(p,"mb)"))):-601===a?f=wp.i18n.__("This file type is not allowed","integrate-google-drive"):"COUNT_ERROR"===a?f=wp.i18n.__("This file was not uploaded. You can`t upload more than","integrate-google-drive")+" ".concat(c," ").concat(wp.i18n.__("files","integrate-google-drive")):-200===a&&(f=JSON.parse(r).data);var m=$("#".concat(s.id));m.length?(m.find(".file-info-error").text(f),m.addClass("error")):setTimeout((function(){var e=$(g);e.attr("id",s.id),e.addClass("error"),e.find(".upload-item-name").text(s.name),e.find(".upload-item-size").text(plupload.formatSize(s.size)),e.find(".file-icon").attr("src",i(s.type)),e.find(".file-info-error").text(f),o.append(e)}),100)}}});plupload.addFileFilter("max_files",(function(i,e,n){i&&this.files.length>=i?(this.trigger("Error",{code:"COUNT_ERROR",file:e}),n(!1)):n(!0)})),_.init()}};const t=s;$=jQuery;var d={init:function(){$(".upwpforms-uploader.image-upload").each((function(){d.initUploader($(this))}))},initUploader:function(e){var n=e.next(".upload-file-list"),a=e.parents("form"),o=e.find(".file-list"),s=a.find('button[type="submit"]'),t=e.data("max-size"),d=e.data("max-post-size");(!t||t>d)&&(t=d);var l=e.data("field-id"),r=e.data("form-id"),p=e.data("min-size"),c=e.data("max-files"),f=e.data("extensions");f=f?f.replace(/\s/g,"").replace(/,+$/,""):"jpg,jpeg,png,gif";var m=e.data("media-library"),u=[],g='\n            <div class="file-list-item" id="">\n                    <img class="file-icon" width="32" height="32" src=""/>\n\n                    <div class="file-info">\n                        <div class="upload-item">\n                            <span class="upload-item-name"></span>\n                            <span class="upload-item-size"></span>\n                        </div>\n\n                        <div class="file-info-percentage">\n                            <i class="dashicons dashicons-saved"></i>\n                            <img class="spinner-icon" src="'.concat(upwpforms.pluginUrl,'/assets/images/spinner.gif"/>\n                            <span class="percentage">0%</span>\n                            <i class="dashicons dashicons-controls-pause"></i>\n                            <i class="dashicons dashicons-controls-play"></i>\n                            <i class="remove-file dashicons dashicons-no-alt"></i>\n                        </div>\n\n                        <span class="file-info-error"></span>\n                        <div class="file-info-progress">\n                            <span class="file-info-progress-bar"></span>\n                        </div>\n                    </div>\n                </div>\n            '),v=e.find(".upwpforms-uploader-browse"),h=e.find(".upwpforms-uploader-body"),_=new plupload.Uploader({browse_button:v[0],drop_element:h[0],url:upwpforms.ajaxUrl,multi_selection:c>1,filters:{max_files:c,max_file_size:t,min_file_size:p,mime_types:[{title:wp.i18n.__("Image files","upload-fields-for-wpforms"),extensions:f}]},multipart_params:{action:"upwpforms_upload_file",nonce:upwpforms.nonce,media_library:m,field_id:l,form_id:r},init:{postInit:function(i){o.on("click",".remove-file",(function(){var e=$(this).closest(".file-list-item"),n=e.attr("id"),a=i.files;a.find((function(i){return i.id===n}))&&i.removeFile(i.getFile(n)),e.remove(),a.length<c&&h.removeClass("hidden")}))},FilesAdded:function(e,n){n.forEach((function(e){var n=$(g);n.attr("id",e.id),n.find(".upload-item-name").text(e.name),n.find(".upload-item-size").text(plupload.formatSize(e.size));var a=new mOxie.Image;a.onload=function(){n.find(".file-icon").attr("src",a.getAsDataURL()),a.destroy(),a=null},a.onerror=function(){n.find(".file-icon").attr("src",i(e.type))},a.load(e.getSource()),o.append(n)})),e.files.length>=c&&h.addClass("hidden"),e.start()},FileUploaded:function(i,e,n){var a=o.find("#".concat(e.id));a.removeClass("active").addClass("uploaded"),a.find(".percentage").text(wp.i18n.__("Completed","upwpforms"));var t=JSON.parse(n.response);u.push(t.data),s.prop("disabled",!1)},UploadProgress:function(i,e){s.prop("disabled",!0);var n=o.find("#".concat(e.id));n.addClass("active"),n.find(".file-info-progress-bar").css("width",e.percent+"%"),n.find(".percentage").text(e.percent+"%")},UploadComplete:function(i,e){s.prop("disabled",!1),u.length&&n.val(JSON.stringify(u)).trigger("change")},Error:function(e,n){console.log(n);var a=n.code,s=n.file,d=n.message,l=n.type,r=n.response,f=d;-600===a?(f=wp.i18n.__("File size exceeds the maximum upload size.","integrate-google-drive")+"(".concat(t,")"),"min"===l&&(f=wp.i18n.__("File size is less than the minimum upload size.","integrate-google-drive")+"(".concat(p,"mb)"))):-601===a?f=wp.i18n.__("This file type is not allowed","integrate-google-drive"):"COUNT_ERROR"===a?f=wp.i18n.__("You can`t upload more than","integrate-google-drive")+" ".concat(c," ").concat(wp.i18n.__("files","integrate-google-drive")):-200===a&&(f=JSON.parse(r).data);var m=$("#".concat(s.id));m.length?(m.find(".file-info-error").text(f),m.addClass("error")):setTimeout((function(){var e=$(g);e.attr("id",s.id),e.removeClass("active uploaded").addClass("error"),e.find(".upload-item-name").text(s.name),e.find(".upload-item-size").text(plupload.formatSize(s.size)),e.find(".file-icon").attr("src",i(s.type)),e.find(".file-info-error").text(f),o.append(e)}),100)}}});plupload.addFileFilter("max_files",(function(i,e,n){i&&this.files.length>=i?(this.trigger("Error",{code:"COUNT_ERROR",file:e}),n(!1)):n(!0)})),_.init()}};const l=d;var r;r=function(){o.init(),t.init(),l.init()},jQuery(document).ready(r)})();